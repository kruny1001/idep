{
    "collab_server" : "",
    "contents" : "\n# This is the user-interface definition of a Shiny web application.\n# You can find out more about building applications with Shiny here:\n#\n# http://shiny.rstudio.com\n#\n\nlibrary(shiny)\nlibrary(\"shinyAce\") # for showing text files, code\nlibrary(shinyBS) # for popup figures\nlibrary(plotly)\n\nshinyUI(\n#  fluidPage( \n  navbarPage(\"iDEP 0.24\",\n    tabPanel(\"Load Data\",\n    # Load Data Page\n\t  titlePanel(\"Upload Files\"),\n    sidebarLayout(\n      sidebarPanel(\n\t      actionButton(\"goButton\", \"Click here to load demo data\"),\n\t\t      tags$head(tags$style(\"#goButton{color: red;\n                                 font-size: 16px;\n                                 font-style: italic;\n                                 }\"\n                              )\n          ),\t\t\n\t\t      a(h5(\"Reset all\",align = \"right\"), href=\"http://ge-lab.org/idep/\"), \n\t\t      radioButtons(\"dataFileFormat\", label = \"1. Choose data type\", choices = list(\"RNA-seq raw counts data (recommended)\" = 1, \"Normalized expression values (RNA-seq FPKM, microarray, etc.)\" = 2),selected = 1),\n\t        fileInput('file1', '2. Choose file to upload (<50Mb)',\n                  accept = c(\n                    'text/csv',\n                    'text/comma-separated-values',\n                    'text/tab-separated-values',\n                    'text/plain',\n                    '.csv',\n                    '.tsv'\t\t\t\t\t\n                  )\n          ),\n      \t\th4(\"3. Verify guessed species, change if neccessary.\"),\n      \t\tselectInput(\"selectOrg\", label = NULL,\"Best matching species\",width='100%'), \n\t\t      conditionalPanel(\"input.selectOrg == 'NEW'\",\n  \t\t\t    fileInput('gmtFile', '4. Upload a geneset .GMT file for enrichment analysis (optional)',\n                      accept = c(\n                        'text/csv',\n                        'text/comma-separated-values',\n                        'text/tab-separated-values',\n                        'text/plain',\n                        '.csv',\n                        '.tsv',\n  \t\t\t\t\t            '.gmt'\t\t\t\t\t\n                      )\n            )\n\t\t      ),\n          tableOutput('species' ),\n\t\t      a(\"Help\", href=\"https://idepsite.wordpress.com/data-format/\")\n\n      ),\n      mainPanel(\n        tableOutput('contents'),\n        h5(\"Integrated Differential Expression and Pathway analysis (iDEP) of genomics data.  See \",\n    \t    a(\" documentation\", href=\"https://idepsite.wordpress.com/\"), \"and\",\n          a(\" demo.\", href=\"https://idepsite.wordpress.com/demo/\"),\n          \"Based on annotation of\"\n    \t    ,a( \" 69 metazoa and 42 plant genomes \",href=\"https://idepsite.wordpress.com/species/\") ,\"in Ensembl BioMart as of 11/15/2016.\"\n          ,\" Additional  data from\"\n    \t\t\t,a(\"KEGG, \", href=\"www.genome.jp/kegg/\")\n    \t\t\t,a(\"Reactome, \", href=\"http://www.reactome.org/\")\n    \t\t\t,a(\"MSigDB (human),\", href=\"https://doi.org/10.1093/bioinformatics/btr260\") \n          ,a(\"GSKB (mouse)\", href=\"http://biorxiv.org/content/early/2016/10/24/082511\") \n          ,\"and\",a(\"  araPath (arabidopsis).\", href=\"https://doi.org/10.1093/bioinformatics/bts421\") \n          ,\" For feedbacks or data contributions (genes and GO mapping of any species), please\"\n          ,a(\"contact us, \",href=\"mailto:xijin.ge@sdstate.edu?Subject=ShinyGO\" )\n          , \"or visit our\",a(\" homepage.\", href=\"http://ge-lab.org/\")\n    \t\t  , \"Send us suggestions or any error message to help improve iDEP.\"\n        ) \t\t\n  \t\t  ,htmlOutput('fileFormat')\n      )\n    )\n  ) # End Load Page\n  ,tabPanel(\"Pre-Process\",\n    sidebarLayout(\n      sidebarPanel(\n\t\t\t  conditionalPanel(\"input.dataFileFormat == 2\"\n          ,numericInput(\"lowFilter\",label = h5(\"Only keep genes with expression at least\"), value = 1)\n\t\t\t\t  ,radioButtons(\"transform\", \"Log Transformation\",c(\"No\"=FALSE,\"Yes\"=TRUE) )\n\t\t\t\t  ,numericInput(\"logStart\", label = h5(\"Constant c for started log: log(x+c)\"), value = 1)\n\t\t\t\t  ,br(),h4( textOutput(\"text.transform\") )\n\t\t\t\t)\n\t\t\t\t,conditionalPanel(\"input.dataFileFormat == 1\", numericInput(\"minCounts\", \n\t\t\t\t                                                            label = h5(\"Removing genes with less than this many reads in all samples: \"), value = 10) \n   \t\t\t\t,radioButtons(\"CountsTransform\", \"Transform counts data for clustering & PCA.\",  c(\"VST: variance stabilizing transform\"=2, \"rlog: regularized log (only for N<10) \"= 3,\"Started log: log2(x+c)\" = 1),selected = 1 )\n  \t\t\t\t,conditionalPanel(\"input.CountsTransform == 1\",numericInput(\"countsLogStart\", label = h5(\"Constant c for started log\"), value = 4))\n   \t\t\t\t#,radioButtons(\"CountsDEGMethod\", \"Detect differntial expression using:\",  c(\"limma-voom\"=2,\"limma-trend\"=1,\"DESeq2\"= 3) )\n  \t\t\t\t,actionButton(\"examineDataB\", \"Search processed data\")\n\t\t\t\t)\n        ,br(),br()\n\t\t\t\t,downloadButton('downloadProcessedData', 'Download processed data') \n\t\t\t\t,br()\n\t\t\t  ,a(\"Help\", href=\"https://idepsite.wordpress.com/pre-process/\")\n      ),\n      mainPanel(\n\t\t\t   conditionalPanel(\"input.dataFileFormat == 1\", plotOutput(\"totalCounts\") )\n         ,plotOutput(\"EDA\")\n\t\t\t\t ,bsModal(\"modalExample10\", \"Converted data (Most variable genes on top)\", \"examineDataB\", size = \"large\", DT::dataTableOutput('examineData'))\n      )\n    )       \n  )\n  ,tabPanel(\"Heatmap\",\n              sidebarLayout(\n                sidebarPanel(\n   \t\t\t\t\tsliderInput(\"nGenes\", label = h4(\"Most variable genes to include:\"), min = 10, max = 2000, value = 1000,step=50) \n\t\t\t\t\t,downloadButton('downloadData', 'Download heatmap data')\n\t\t\t\t\t,br(),br()\n\t\t\t\t\t,actionButton(\"showCorrelation\", \"Show correlation matrix\")\n\t\t ,br(),br(), h4(\"Mouse over to see gene names. To zoom, click and drag up or downward and relase.\")\n\t\t\t,br(),a(\"Help\", href=\"https://idepsite.wordpress.com/heatmap/\")\n\t\t\t\t\t),\n                mainPanel(\t\t\t\t  \n  \t\t\t\t  plotlyOutput(\"heatmap\",width = \"100%\", height = \"800px\")\n\t\t\t\t # ,verbatimTextOutput(\"event\")\n\t\t\t\t  ,bsModal(\"modalExample8\", \"Correlation matrix using all genes\", \"showCorrelation\", size = \"large\",plotOutput(\"correlationMatrix\"))\n\t\t\t\t \n                )\n              )       \n    )\n\t,tabPanel(\"k-Means\",\n              sidebarLayout(\n                sidebarPanel(\n\t\t\t\t#numericInput(\"nClusters\", label = h4(\"Number of Clusters (often <15) \"), value = 6)\n   \t\t\t\tsliderInput(\"nGenesKNN\", label = h4(\"Most variable genes to include \"), min = 10, max = 6000, value = 2000,step=100) \n\t\t\t\t,sliderInput(\"nClusters\", label = h4(\"Number of Clusters\"), min = 2, max = 20, value = 4,step=1) \n\t\t\t\t\n\t\t\t\t,actionButton(\"showMotifKmeans\", \"Promoter analysis of each cluster\")\n\t\t\t\t,br(),br(),downloadButton('downloadDataKmeans', 'Download K-means data')\n\t\t\t\t,h5(\"Database for enrichment analysis\")\n\t\t\t\t,htmlOutput(\"selectGO3\"),tags$style(type='text/css', \"#selectGO3 { width:100%;   margin-top:-9px}\")\n\t\t\t\t,actionButton(\"NClusters\", \"How many clusters?\")\n\t\t\t\t\t\t ,br(),br()\n\t\t\t,a(\"Help\", href=\"https://idepsite.wordpress.com/k-means/\")\n\t\t\t\t),\n                mainPanel(\n                  plotOutput(\"KmeansHeatmap\")\n\t\t\t\t  ,br(),br(),br(),br()\n\t\t\t\t  ,h4(\"Enriched pathways for each cluster\")\n\t\t\t\t  ,tableOutput(\"KmeansGO\")\n\t\t\t\t  ,bsModal(\"modalExample2\", \"Enriched TF binding motifs in promoters of Kmeans clusters\", \"showMotifKmeans\", size = \"large\"\n\t\t\t\t   ,radioButtons(\"radioPromoterKmeans\", label = NULL, choices = list(\"Upstream 300bp as promoter\" = 300, \"Upstream 600bp as promoter\" = 600),selected = 300)\n\t\t\t\t   ,tableOutput(\"KmeansPromoter\"))\n\t\t\t\t  ,bsModal(\"modalExample9\", \"Determining the number of clusters (k)\", \"NClusters\", size = \"large\",\n\t\t\t\t  h5(\"Following the elbow method, one should choose k so that adding another cluster does not substantially reduce the within groups sum of squares.\"\n\t\t\t,a(\"Wikipedia\", href=\"https://en.wikipedia.org/wiki/Determining_the_number_of_clusters_in_a_data_set\"))\n\t\t\t\t  ,plotOutput(\"KmeansNclusters\"))\n\n                )\n              )       \n    )\n     ,tabPanel(\"PCA\",\n              sidebarLayout(\n                sidebarPanel(\n\t\t\t\tradioButtons(\"PCA_MDS\", \"Methods\", c(\"Principal Component Analysis\"=1, \"Pathway Analysis of PCA rotation\" =2, \n\t\t\t\t\"Multidimensional Scaling\"=3))\n\t\t\t\t,downloadButton('downloadPCAData', 'Download Coordinates')\n \t\t\t\t\t#sliderInput(\"nGenes1\", label = h4(\"Most variable genes to include\"), min = 40, max = 2000, value = 200,step=20) \n\t\t\t,br(),br()\n\t\t\t,a(\"Help\", href=\"https://idepsite.wordpress.com/pca/\")\t\t\t\t\n\t\t\t\t),\n                mainPanel(\n                  plotOutput(\"PCA\")\n                )\n              )       \n    )\n\t     ,tabPanel(\"DEGs\",\n              sidebarLayout(\n                sidebarPanel(\n\t\t\t\th5(\"Identifying Differential Expressed Genes (DEGs)\")\n\t\t\t\t,conditionalPanel(\"input.dataFileFormat == 1\",\n\t\t\t    #  radioButtons(\"CountsDEGMethod\", \"Method to detect DEGs:\",  c(\"limma-voom\"=2,\"limma-trend\"=1,\"DESeq2\"= 3) )\n\t\t\t\tselectInput(\"CountsDEGMethod\", \"Method to detect DEGs from read counts:\", choices = list(\"DESeq2\"= 3,\"limma-voom\"=2,\"limma-trend\"=1), selected = 3)\t\t\t\t\n\n\t\t\t\t)\t\t\t\t\n\t\t\t\t,fluidRow(\n\t\t\t\t column(5,numericInput(\"limmaPval\", label = h5(\"FDR cutoff\"), value = 0.1,min=1e-20,max=1,step=.05)  )\n\t\t\t\t ,column(7, numericInput(\"limmaFC\", label = h5(\"Min fold change\"), value = 2,min=1,max=100,step=0.5) )\n\t\t\t\t) # fluidRow\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t,tags$style(type='text/css', \"#limmaPval { width:100%;   margin-top:-12px}\")\n\t\t\t\t,tags$style(type='text/css', \"#limmaFC { width:100%;   margin-top:-12px}\")\n\t\t\t\t,fluidRow(\n\t\t\t\t   column(6,actionButton(\"showVenn\", \"Venn Diagram\") )\n\t\t\t\t\t, column(6, downloadButton('download.DEG.data', 'All lists') )\n\t\t\t\t) # fluidRow\n\t\t\t\t #,hr()\n\t\t\t\t ,HTML('<hr style=\"height:1px;border:none;color:#333;background-color:#333;\" />') # a solid line\n\t\t\t\t ,htmlOutput(\"listComparisons\")\n\t\t\t\t ,h5(\"Genesets for enrichment analysis\")\n\t\t\t\t ,htmlOutput(\"selectGO2\")\n\t\t\t\t,tags$style(type='text/css', \"#selectGO2 { width:100%;   margin-top:-9px}\")\n\t\t\t\t ,br(),fluidRow(\n\t\t\t\t column(6,actionButton(\"showVolcano\", \"Volcano Plot\"))\n\t\t\t\t ,column(6, actionButton(\"showScatter\", \"Scatter Plot\") ) )\n\t\t\t\t ,br(),actionButton(\"showMotif\", \"TF binding motifs in promoter\")\n\t\t\t\t #,radioButtons(\"radio.promoter\", label = NULL, choices = list(\"Upstream 300bp as promoter\" = 300, \"Upstream 600bp as promoter\" = 600),selected = 300)\n\t\t\t\t ,br(),br(),downloadButton('download.selectedHeatmap.data', \"Download gene list & data\" )\n\t\t\t\t,h5(\"You can paste these genes to\",  a(\"ShinyGO\", href=\"http://ge-lab.org:3838/go/\") )\t\n\t\t\t\t,br(),h4( textOutput(\"text.limma\") )\t\t\t\t\t\t\t\t\t\t\n\t\t\t,a(\"Help\", href=\"https://idepsite.wordpress.com/degs/\")\n\t\t\t\t\n\t\t\t\t, width = 4),\n\t\t\t\t\n                mainPanel(\n                  plotOutput(\"selectedHeatmap\")\n\t\t\t\t   ,h4(\"Enriched gene sets in up (A) or down (B) -regulated genes\")\n\t\t\t\t   ,tableOutput(\"geneListGO\")\n\t\t\t\t   ,h4(\"Top Genes\"),tableOutput('geneList')\n\t\t\t\t   #,h4(\"Enriched motif in promoters\")\n\t\t\t\t   #,tableOutput(\"DEG.Promoter\")\n\t\t\t\t   ,bsModal(\"modalExample1\", \"Enriched TF binding motifs in promoters of DEGs\", \"showMotif\", size = \"large\"\n\t\t\t\t   ,radioButtons(\"radio.promoter\", label = NULL, choices = list(\"Upstream 300bp as promoter\" = 300, \"Upstream 600bp as promoter\" = 600),selected = 300)\n\t\t\t\t   ,tableOutput(\"DEG.Promoter\"))\n\t\t\t\t   ,bsModal(\"modalExample\", \"Venn Diagram\", \"showVenn\", size = \"large\",plotOutput(\"vennPlot\"))\n\t\t\t\t   ,bsModal(\"modalExample4\", \"Volcano plot\", \"showVolcano\", size = \"large\",plotOutput(\"volcanoPlot\"))\n\t\t\t\t   ,bsModal(\"modalExample5\", \"Scatter plot\", \"showScatter\", size = \"large\",plotOutput(\"scatterPlot\"))\n\t\t\t\t  \n                )\n              )       \n    )\n   ,tabPanel(\"Pathways\",\n              sidebarLayout(\n                sidebarPanel(\n\t\t\t\thtmlOutput(\"listComparisonsPathway\")\n\t\t\t\t,tags$style(type='text/css', \"#listComparisonsPathway { width:100%;   margin-top:-12px}\")\n\t\t\t,selectInput(\"pathwayMethod\", label = \"Select method and genesets:\", choices = list(\"GAGE\" = 1,  \"GSEA (preranked fgsea)\" =3,\"PGSEA\" = 2, \"PGSEA w/ all samples\" =4, \"ReactomePA\" = 5), selected = 1) #\n\t\t\t\t,tags$style(type='text/css', \"#pathwayMethod { width:100%;   margin-top:-12px}\")\n\t\t\t\t,htmlOutput(\"selectGO1\")\n\t\t\t\t,tags$style(type='text/css', \"#selectGO1 { width:100%;   margin-top:-12px}\")\n                ,h5(\"Genesets size filter:\")\n\t\t\t\t,fluidRow( \n\t\t\t\tcolumn(6,numericInput(\"minSetSize\", label = \"Min\", min = 5, max = 30, value = 15,step=1) \n\t\t\t           ),\n\t\t\t\tcolumn(6,numericInput(\"maxSetSize\", label = \"Max\", min = 1000, max = 2000, value = 2000,step=100) \n\t\t\t\t\t\t)\n\t\t\t\t) # fluidRow\n\t\t\t\t,numericInput(\"pathwayPvalCutoff\", label = h5(\"Pathway signifiance cutoff (FDR)\"), value = 0.1,min=1e-20,max=1,step=.05)\n\t\t\t\t,tags$style(type='text/css', \"#pathwayPvalCutoff { width:100%;   margin-top:-12px}\")\n\t\t\t\t,numericInput(\"nPathwayShow\", label = h5(\"Number of top pathways to show\"), value = 30, min=5,max=100,step=5)\n\t\t\t\t,tags$style(type='text/css', \"#nPathwayShow { width:100%;   margin-top:-12px}\")\n\t\t\t\t,checkboxInput(\"absoluteFold\", label = \"Use absolute values of fold changes for GSEA and GAGE\", value = FALSE)\n\t\t\t\t#,actionButton(\"examinePathway\", \"Examine individual pathways\")\n\t\t\t\t,conditionalPanel(\"input.pathwayMethod == 2\",downloadButton('download.PGSEAplot.data', 'Download PGSEA pathway data'))\n\t\t\t\t\t\t\t\n\t\t\t,a(\"Help\", href=\"https://idepsite.wordpress.com/pathways/\")\t\t\n\t\t\t\t),\n                mainPanel(\t  \n\t\t\t\t\t\n\t\t\t\t  conditionalPanel(\"input.pathwayMethod == 2\",\n                  plotOutput(\"PGSEAplot\") )\n\t\t\t\t  ,conditionalPanel(\"input.pathwayMethod == 1\",\n                  tableOutput(\"gagePathway\") )\n\t\t\t\t  ,conditionalPanel(\"input.pathwayMethod == 3\",\n                  tableOutput(\"fgseaPathway\") )\n\t\t\t\t   ,conditionalPanel(\"input.pathwayMethod == 5\",\n                  tableOutput(\"ReactomePAPathway\") )\n\t\t\t\t  ,conditionalPanel(\"input.pathwayMethod == 4\",\n\t\t\t\t  plotOutput(\"PGSEAplotAllSamples\") )\n\t\t\t\t   ,conditionalPanel(\"input.pathwayMethod == 1 | input.pathwayMethod == 3\" \n\t\t\t\t    ,htmlOutput(\"listSigPathways\")\n\t\t\t\t\t,downloadButton('downloadSelectedPathwayData', 'Download expression data for selected pathway')  )\n\t\t\t\t\t,conditionalPanel(\" (input.pathwayMethod == 1 | input.pathwayMethod == 3 ) & input.selectGO == 'KEGG'\",imageOutput(\"KeggImage\"))\n\t\t\t\t\t,conditionalPanel(\"(input.pathwayMethod == 1 | input.pathwayMethod == 3 ) & input.selectGO != 'KEGG'\",plotOutput(\"selectedPathwayHeatmap\")) \n\t\t\t   \n                )\n              )       \n    )\n   ,tabPanel(\"Chromosome\",\n              sidebarLayout(\n                sidebarPanel(\n\t\t\t\th5(\"Identifying genomic regions enriched with up- or down-regulation genes based on \"\n\t\t\t\t,a(\"PREDA.\", href=\"https://academic.oup.com/bioinformatics/article/27/17/2446/224332/PREDA-an-R-package-to-identify-regional-variations\"),\n\t\t\t\t\"Very slow (5 mins), but may be useful in studying cancer or other diseases that might involve chromosomal gain or loss.\"\t)\n\t\t\t\t,htmlOutput(\"listComparisonsGenome\")\n\t\t\t\t,tags$style(type='text/css', \"#listComparisonsPathway { width:100%;   margin-top:-12px}\")\n\t\t\t\t,fluidRow( \n\t\t\t\t\tcolumn(6,numericInput(\"RegionsPvalCutoff\", label = h5(\"Min. FDR\"), value = 0.01,min=1e-20,max=1,step=.05) \n\t\t\t\t\t),\n\t\t\t\t\tcolumn(6,numericInput(\"StatisticCutoff\", label = h5(\"Min. Statistic\"), min = .2, max = 1.5, value = .5,step=.1) \n\t\t\t\t\t#column(6,numericInput(\"nPermutations\", label = h5(\"Permutations\"), min = 500, max = 3000, value = 1000,step=100) \n\t\t\t\t)\n\t\t\t\t\t\t\n\t\t\t\t) # fluidRow\n\t\t\t\t,actionButton(\"showRegions\", \"Significant Genomic Regions\")\n\t\t\t\t,br(),br()\n\t\t\t\t,actionButton(\"showGenesRegions\", \"Genes in Genomic Regions\")\n\t\t\t\t,h4(\"Chr. Regions\")\n\t\t\t\t,tableOutput(\"chrRegionsList\")\n\t\t\t\t),\n                mainPanel(\t  \n\t\t\t\t\tplotOutput(\"genomePlot\")\n\t\t\t\t\t,bsModal(\"modalExample15\", \"Diff. expressed regions\", \"showRegions\", size = \"large\",downloadButton('downloadRegions', 'Download'),dataTableOutput(\"chrRegions\"))\n\t\t\t\t,bsModal(\"modalExample16\", \"Diff. expressed regions\", \"showGenesRegions\", size = \"large\",downloadButton('downloadGenesInRegions', 'Download'),dataTableOutput(\"genesInChrRegions\"))\n\n                )\n              )       \n    )\n\t\n#   ,tabPanel(\"Code\",\n#      fluidRow(\n#       column(12,\n#          \"R codes for reference\",\n#            sourceCode1 <- aceEditor(\"code\"\n#  , value = paste(readLines(\"ui.R\"), collapse=\"\\n\")\n#  , mode = \"r\"\n#  , theme = \"ambience\"\n#  , height = \"400px\"\n#  , readOnly = TRUE\n#  ) )))\n\n#  ,tabPanel(\"Info\",\n#      fluidRow(\n#       column(12,\n #    textOutput('RsessionInfo')\n# ) ))\n\n   ,tags$head(includeScript(\"google_analytics.js\")) # tracking usage  \n  )# Navibar\n # ) # fluid page\n   \n\n)\n",
    "created" : 1494309909926.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1072543363",
    "id" : "63491D56",
    "lastKnownWriteTime" : 1494363834,
    "last_content_update" : 1494363834654,
    "path" : "~/Desktop/idep/ui.R",
    "project_path" : "ui.R",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}